2026-02-23 10:09:06 | INFO | feature_engineering | Params: min_df=5, max_df=0.9, token_pattern=\b[a-z]{3,15}\b, ngram_range=(1, 2), text_col=text_norm, label_col=label
2026-02-23 10:09:07 | INFO | feature_engineering | Train processed shape: (327411, 3)
2026-02-23 10:09:07 | INFO | feature_engineering | Test processed shape: (81744, 3)
2026-02-23 10:09:14 | INFO | feature_engineering | BoW train matrix: (327411, 84564)
2026-02-23 10:09:14 | INFO | feature_engineering | BoW test matrix: (81744, 84564)
2026-02-23 10:09:14 | ERROR | feature_engineering | Feature engineering échoué.
Traceback (most recent call last):
  File "C:\Users\abotsi\Desktop\Projet_pro\projet_mlops_ref_basique\src\data\feature_engineering.py", line 104, in main
    train_bow_df = pd.DataFrame(X_train_bow.toarray())
                                ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\abotsi\Desktop\Projet_pro\env_usa_visa\Lib\site-packages\scipy\sparse\_compressed.py", line 1005, in toarray
    out = self._process_toarray_args(order, out)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\abotsi\Desktop\Projet_pro\env_usa_visa\Lib\site-packages\scipy\sparse\_base.py", line 1523, in _process_toarray_args
    return np.zeros(self.shape, dtype=self.dtype, order=order)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
numpy._core._exceptions._ArrayMemoryError: Unable to allocate 206. GiB for an array with shape (327411, 84564) and data type int64
2026-02-23 10:14:10 | INFO | feature_engineering | Params: min_df=5, max_df=0.9, token_pattern=\b[a-z]{3,15}\b, ngram_range=(1, 2), text_col=text_norm, label_col=label
2026-02-23 10:14:12 | INFO | feature_engineering | Train processed shape: (327411, 3)
2026-02-23 10:14:12 | INFO | feature_engineering | Test processed shape: (81744, 3)
2026-02-23 10:14:26 | INFO | feature_engineering | BoW train matrix: (327411, 84564) (nnz=4346624)
2026-02-23 10:14:26 | INFO | feature_engineering | BoW test matrix: (81744, 84564) (nnz=1063285)
2026-02-23 10:14:41 | INFO | feature_engineering | TFIDF train matrix: (327411, 84564) (nnz=4346624)
2026-02-23 10:14:41 | INFO | feature_engineering | TFIDF test matrix: (81744, 84564) (nnz=1063285)
2026-02-23 10:14:48 | INFO | feature_engineering | ✅ Feature engineering terminé (sparse saved).
2026-02-23 10:37:31,278 | INFO | feature_engineering | Config loaded | methods=['bow', 'tfidf'] | min_df=5 | max_df=0.9 | ngram_range=(1, 2)
2026-02-23 10:37:32,267 | INFO | feature_engineering | Train processed shape: (327411, 3)
2026-02-23 10:37:32,267 | INFO | feature_engineering | Test processed shape: (81744, 3)
2026-02-23 10:37:39,283 | INFO | feature_engineering | BOW train: (327411, 84564) | nnz=4346624
2026-02-23 10:37:39,283 | INFO | feature_engineering | BOW test: (81744, 84564) | nnz=1063285
2026-02-23 10:37:49,674 | INFO | feature_engineering | TFIDF train: (327411, 84564) | nnz=4346624
2026-02-23 10:37:49,674 | INFO | feature_engineering | TFIDF test: (81744, 84564) | nnz=1063285
2026-02-23 10:37:53,950 | INFO | feature_engineering | Feature engineering terminé (modulaire, sans classes).
